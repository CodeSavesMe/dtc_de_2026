

## Glossary
---

| Istilah                            | Arti singkat                                                  | Di repo kamu (contoh)                                                   | Kenapa penting                                                   |
| ---------------------------------- | ------------------------------------------------------------- | ----------------------------------------------------------------------- | ---------------------------------------------------------------- |
| **I/O (Input/Output)**             | Aktivitas baca/tulis dari/ke luar program (disk, network, DB) | download file (network), baca CSV/Parquet (disk), COPY ke Postgres (DB) | I/O sering jadi bottleneck; desain chunk/batch membantu performa |
| **Network I/O**                    | I/O lewat jaringan                                            | `requests.get(url, stream=True)`                                        | Butuh timeout/retry agar robust                                  |
| **Disk I/O**                       | I/O ke filesystem                                             | simpan file ke `data/`                                                  | Penting untuk cache & reliability                                |
| **DB I/O**                         | I/O ke database                                               | `COPY FROM STDIN`, `INSERT`, `ANALYZE`                                  | Menentukan throughput ingestion                                  |
| **CLI (Command Line Interface)**   | Program yang dijalankan via terminal                          | `click` commands (`ingest`, `ingest-url`)                               | Mudah dipakai automation (Docker/Kestra)                         |
| **Command**                        | Sub-perintah dalam CLI                                        | `@cli.command("ingest")`                                                | Membagi fungsi job                                               |
| **Option/Flag**                    | Argumen CLI (mis. `--month`)                                  | `click.option("--if-exists", ...)`                                      | Mengontrol perilaku program                                      |
| **Environment Variable (ENV var)** | Konfigurasi via OS environment                                | `DB_HOST`, `IF_EXISTS`, `ENABLE_PROGRESS`                               | Standar enterprise untuk deploy                                  |
| **dotenv**                         | Load env var dari file `.env`                                 | `load_dotenv(... override=False)`                                       | Memudahkan local dev                                             |
| **override=False**                 | `.env` tidak menimpa env sistem                               | `load_dotenv(... override=False)`                                       | Docker/Kestra env tetap menang                                   |
| **Dependency Injection (DI)**      | Dependency “disuntik” dari luar                               | `build_pipeline(pg_client, loader_settings)`                            | Mudah testing & modular                                          |
| **Ingestion**                      | Memasukkan data ke target storage                             | `pipeline.run(...)`                                                     | Fokus “load data” end-to-end                                     |
| **ETL**                            | Extract-Transform-Load                                        | Extract=download, Transform=coerce, Load=COPY                           | Pola umum data engineering                                       |
| **Orchestration**                  | Mengatur urutan step & retry/schedule                         | CLI + Kestra (konsep)                                                   | Penting untuk production runs                                    |
| **Pipeline**                       | Rangkaian step terstruktur                                    | `IngestionPipeline.run`                                                 | Membuat flow konsisten & repeatable                              |
| **Core (domain/core)**             | Bagian orchestration utama                                    | `core/ingestion_pipeline.py`                                            | Harus bersih dari detail infra                                   |
| **Ports & Adapters (Hexagonal)**   | Core bergantung interface, adapter implement                  | `ports/*` + `db/*`                                                      | Enterprise-friendly, testable                                    |
| **Port**                           | Kontrak interface                                             | `Database`, `Loader`, `Validator` (Protocol)                            | Core tidak “ngunci” implementasi                                 |
| **Adapter**                        | Implementasi konkret dari port                                | `PostgresClient`, `CsvCopyLoader`, `AtomicSwapper`                      | Bisa diganti tanpa ubah core                                     |
| **Protocol (typing)**              | Interface kontrak di Python typing                            | `class Database(Protocol)`                                              | Membantu type-check & desain                                     |
| **Type hints**                     | Anotasi tipe untuk readability & tooling                      | `def load(...)->None`, `Optional[str]`                                  | Mengurangi bug, bantu IDE                                        |
| **TYPE_CHECKING**                  | Flag untuk import hanya saat type-check                       | `if TYPE_CHECKING: ...`                                                 | Hindari circular import runtime                                  |
| **Circular import**                | Import yang saling memanggil, bikin error                     | core ↔ adapters bisa memicu                                             | Dicegah dengan TYPE_CHECKING                                     |
| **dataclass**                      | Cara cepat bikin class data                                   | `@dataclass(frozen=True)`                                               | Kode lebih ringkas & jelas                                       |
| **frozen=True**                    | dataclass immutable (read-only)                               | `IngestionPipeline`, `PostgresClient`                                   | Mengurangi side-effects                                          |
| **Context manager**                | Pola `with ...:` untuk resource mgmt                          | `with db.begin():`, `with lock.acquire():`                              | Auto cleanup, aman                                               |
| **ContextManager**                 | Tipe untuk context manager                                    | di ports (`ContextManager[Connection]`)                                 | Membantu kontrak ports                                           |
| **Transaction**                    | Unit kerja DB atomic (commit/rollback)                        | `with db.begin() as conn:`                                              | Menjamin konsistensi data                                        |
| **Commit**                         | Mengunci perubahan transaksi                                  | `raw_conn.commit()`                                                     | Sukses load jadi permanen                                        |
| **Rollback**                       | Membatalkan perubahan                                         | `raw_conn.rollback()`                                                   | Menjaga DB bersih saat error                                     |
| **Idempotency**                    | Run ulang hasilnya tetap benar/sama                           | replace via swap mendekati idempotent                                   | Penting untuk retry scheduler                                    |
| **Retry**                          | Mengulang step saat gagal                                     | belum ada built-in retry network                                        | Enterprise perlu reliability                                     |
| **Timeout**                        | Batas waktu operasi                                           | `requests.get(... timeout=60)`, lock timeout                            | Cegah job hang                                                   |
| **Backoff**                        | Jeda meningkat saat retry                                     | (recommended)                                                           | Menghindari thundering herd                                      |
| **Atomic operation**               | Operasi “all-or-nothing”                                      | `os.replace(.part, final)`                                              | Mencegah partial state                                           |
| **Atomic write pattern**           | Download ke `.part` lalu rename                               | `download_file()`                                                       | File final hanya ada jika sukses                                 |
| **Cache (download)**               | Skip download bila file sudah ada                             | `exists && size>0`                                                      | Menghemat waktu/bandwidth                                        |
| **Checksum/ETag**                  | Validasi integritas file                                      | belum ada                                                               | Enterprise biasanya menambah ini                                 |
| **File format**                    | Jenis file: CSV/TSV/Parquet                                   | `FileFormat` enum                                                       | Menentukan loader & schema                                       |
| **Extension-based detection**      | Deteksi format dari ekstensi                                  | `detect_file_format()`                                                  | Cepat tapi bisa salah bila ext salah                             |
| **Compression infer**              | pandas auto-detect `.gz`                                      | `compression="infer"`                                                   | Praktis untuk `.csv.gz`                                          |
| **Gzip (.gz)**                     | Kompresi file umum                                            | `.csv.gz`                                                               | Menghemat storage/network                                        |
| **CSV**                            | Text file comma-separated                                     | `CsvCopyLoader`                                                         | Format umum data                                                 |
| **TSV**                            | Text file tab-separated                                       | `TsvCopyLoader`                                                         | Format umum alternatif                                           |
| **Delimiter / Separator**          | Pemisah kolom di file                                         | CSV=`,`, TSV=`\t`                                                       | Salah delimiter → parsing rusak                                  |
| **Header**                         | Baris nama kolom di file                                      | `pd.read_csv(... dtype=str)`                                            | Dipakai mapping kolom                                            |
| **Duplicate header**               | Nama kolom ganda                                              | TSV loader cek duplikat                                                 | Mencegah ambiguity mapping                                       |
| **Schema**                         | Struktur table: kolom + tipe                                  | `PostgresSchemaManager`                                                 | Harus konsisten agar load aman                                   |
| **Bootstrap schema**               | Membuat schema awal dari file                                 | CSV sample / Parquet footer                                             | Memudahkan onboarding data                                       |
| **Sample-based inference**         | Infer tipe dari sample rows                                   | `pd.read_csv(nrows=...)`                                                | Risiko bias sample (tradeoff)                                    |
| **Parquet**                        | Format kolumnar dengan schema metadata                        | `pyarrow.parquet`                                                       | Lebih cepat & schema-rich                                        |
| **Parquet footer**                 | Metadata schema di Parquet                                    | `ParquetFile(...).schema_arrow`                                         | Infer schema akurat tanpa sample                                 |
| **Arrow**                          | Format memory columnar (pyarrow)                              | type mapping arrow→pg                                                   | Mempercepat pipeline Parquet                                     |
| **Type mapping**                   | Mapping tipe antar sistem                                     | `_arrow_type_to_pg()`                                                   | Mencegah mismatch schema                                         |
| **DDL**                            | SQL untuk definisi struktur                                   | `CREATE TABLE`, `DROP TABLE`                                            | Mengatur schema                                                  |
| **DML**                            | SQL untuk data manipulation                                   | `INSERT`, `COPY`                                                        | Memuat & ubah data                                               |
| **COPY FROM STDIN**                | Bulk load Postgres via stream                                 | `cur.copy_expert(copy_sql, buf)`                                        | Sangat cepat dibanding INSERT row-by-row                         |
| **STDIN (stream)**                 | Input stream ke perintah COPY                                 | `io.StringIO()` buffer                                                  | Efisien untuk batch load                                         |
| **Buffer**                         | Temp storage in-memory sebelum kirim DB                       | `buf = io.StringIO()`                                                   | Kontrol memory & throughput                                      |
| **COPY delimiter**                 | Delimiter saat Postgres parse stream                          | `DELIMITER ','` / `self.delimiter`                                      | Harus match output `to_csv`                                      |
| **NULL representation**            | Representasi NULL dalam text                                  | `NULL ''` + `na_rep=""`                                                 | Mencegah string `"nan"` masuk DB                                 |
| **Quoting**                        | Cara escape field berisi delimiter/quote                      | `quoting=csv.QUOTE_MINIMAL`                                             | Cegah parsing error COPY                                         |
| **Line terminator**                | Akhiran baris                                                 | `lineterminator="\n"`                                                   | Stabil di berbagai OS                                            |
| **Chunk**                          | Unit baca file per iterasi                                    | `chunksize=self.chunk_size`                                             | Kontrol memory footprint                                         |
| **Batch**                          | Unit flush ke DB                                              | slice `batch_size`                                                      | Mengatur ukuran buffer                                           |
| **Memory footprint**               | Penggunaan RAM                                                | chunk/batch tuning                                                      | Penting untuk container kecil                                    |
| **DataFrame**                      | Struktur tabel pandas                                         | `pd.read_csv(...)` menghasilkan DF                                      | Mudah transform/coerce                                           |
| **Coercion**                       | Memaksa tipe data                                             | `pd.to_numeric(... errors="coerce")`                                    | Menghindari DB error                                             |
| **errors="coerce"**                | Invalid parsing jadi NaN/NaT                                  | numeric/datetime conversions                                            | Lebih toleran pada dirty data                                    |
| **Nullable Int64 (pandas)**        | Integer yang bisa NULL                                        | `astype("Int64")`                                                       | Penting agar NaN jadi NULL                                       |
| **NaN / NaT**                      | Missing value numeric / datetime                              | hasil `coerce`                                                          | Akan jadi NULL di Postgres                                       |
| **Datetime normalization**         | Standardize datetime columns                                  | `fix_datetime_columns()`                                                | Konsistensi waktu & validasi                                     |
| **Rowcount**                       | Jumlah baris                                                  | `SELECT COUNT(*)`                                                       | Validasi staging tidak kosong                                    |
| **Data quality check**             | Validasi kualitas data                                        | month spillover thresholds                                              | Enterprise butuh policy jelas                                    |
| **Expected month**                 | Bulan yang diharapkan dari nama table                         | regex `YYYY_MM`                                                         | Menghubungkan data ke partisi waktu                              |
| **Spillover**                      | Baris keluar dari bulan expected                              | outside_month count/ratio                                               | Deteksi “data salah bulan”                                       |
| **Threshold**                      | Batas toleransi                                               | abs 200, ratio 0.005                                                    | Memisahkan warn vs fail                                          |
| **Warn vs Fail policy**            | Pelanggaran jadi warning atau error                           | `fail_on_outside_month`                                                 | Menentukan behavior di prod                                      |
| **Staging table**                  | Table sementara untuk load/validate                           | `{final}__staging`                                                      | Aman: final tidak “kotor”                                        |
| **Final table**                    | Table publish (hasil akhir)                                   | `yellow_tripdata_2024_01`                                               | Dipakai query downstream                                         |
| **Append strategy**                | Tambah data ke final                                          | `INSERT INTO final SELECT * FROM staging`                               | Untuk incremental load                                           |
| **Replace strategy**               | Ganti isi final via swap                                      | rename staging→final                                                    | Minim downtime & safer publish                                   |
| **Atomic swap**                    | Mengganti final via rename dalam transaksi                    | `ALTER TABLE ... RENAME`                                                | Menghindari partial publish                                      |
| **Backup table**                   | Table sementara saat swap                                     | `{final}__backup`                                                       | Safety saat rename final                                         |
| **to_regclass**                    | Cek table exist di Postgres                                   | `SELECT to_regclass(:t)`                                                | Cek existence aman                                               |
| **Fully qualified table**          | `schema.table`                                                | `_qtable()` → `"schema"."table"`                                        | Hindari ambiguity & aman                                         |
| **Identifier**                     | Nama schema/table/kolom                                       | `table_name`, `schema`                                                  | Harus aman dari injection                                        |
| **Identifier sanitization**        | Whitelist nama identifier                                     | `sanitize_ident()` regex ketat                                          | Security baseline                                                |
| **Quoting identifier**             | Membungkus identifier dengan `"`                              | `qident(name)`                                                          | Menghindari reserved word issues                                 |
| **SQL Injection**                  | Serangan melalui input SQL                                    | dicegah via sanitize+qident                                             | Wajib enterprise                                                 |
| **Information schema**             | Metadata DB standar                                           | `information_schema.columns`                                            | Ambil columns order & types                                      |
| **Column order**                   | Urutan kolom di table                                         | `ORDER BY ordinal_position`                                             | COPY harus sesuai urutan kolom                                   |
| **Data type (PG)**                 | Tipe kolom Postgres                                           | `get_table_column_types()`                                              | Dipakai untuk coercion                                           |
| **Numeric types**                  | Float/decimal categories                                      | `_NUM_TYPES`                                                            | Coerce numeric aman                                              |
| **Integer types**                  | bigint/int/smallint                                           | `_INT_TYPES`                                                            | Coerce int & nullify decimals                                    |
| **Fractional in integer col**      | Nilai 1.5 di kolom int                                        | `has_decimals` → set NULL                                               | Mencegah COPY gagal                                              |
| **Logger**                         | Sistem logging                                                | `loguru.logger`                                                         | Observability & debugging                                        |
| **Log level**                      | Tingkat log (INFO/DEBUG/ERROR)                                | `LOG_LEVEL`, file sink DEBUG                                            | Mengontrol verbosity                                             |
| **Structured logging**             | Log berbentuk field                                           | (recommended) `logger.bind(run_id=...)`                                 | Mudah trace per job                                              |
| **Progress bar**                   | Tampilan progress di terminal                                 | `tqdm` + `track()`                                                      | UX saat run manual                                               |
| **NoopProgress**                   | Progress dummy (no-op)                                        | `yield NoopProgress()`                                                  | Aman saat tqdm tidak tersedia                                    |
| **tqdm-safe logging**              | Log tidak merusak progress                                    | `tqdm.write` di sink                                                    | Output lebih rapi                                                |
| **Engine (SQLAlchemy)**            | Objek koneksi pool ke DB                                      | `create_engine(...)`                                                    | Mengatur koneksi & pooling                                       |
| **pool_pre_ping**                  | Cek koneksi sebelum pakai                                     | `pool_pre_ping=True`                                                    | Mengurangi stale connection error                                |
| **Connection (SQLAlchemy)**        | Koneksi DB dari engine                                        | `with engine.connect()`                                                 | Eksekusi query                                                   |
| **raw_connection**                 | Koneksi driver asli (psycopg2)                                | `engine.raw_connection()`                                               | Dibutuhkan untuk COPY performa                                   |
| **psycopg2**                       | Driver Postgres Python                                        | `postgresql+psycopg2`                                                   | Backend koneksi & COPY                                           |
| **SQLAlchemy text()**              | Membuat SQL raw statement                                     | `text("SELECT ...")`                                                    | Parameter binding lebih aman                                     |
| **Parameter binding**              | Menghindari SQL injection                                     | `text(...), {"t": reg_final}`                                           | Best practice SQL                                                |
| **IntegrityError**                 | Error constraint DB                                           | `exc.IntegrityError`                                                    | Append bisa gagal karena PK/unique                               |
| **Constraint**                     | Aturan DB (PK, unique, FK)                                    | tercopy via `LIKE INCLUDING ALL`                                        | Menjaga konsistensi data                                         |
| **Index**                          | Struktur percepat query                                       | ikut tercopy ke staging                                                 | Penting untuk performance                                        |
| **ANALYZE**                        | Update statistik planner                                      | `optimizer.analyze(table)`                                              | Planner lebih akurat setelah bulk load                           |
| **Query planner**                  | Komponen Postgres pilih plan                                  | terbantu oleh ANALYZE                                                   | Tanpa stats, query bisa lambat                                   |
| **Advisory lock**                  | Lock app-level di Postgres                                    | `pg_try_advisory_lock`                                                  | Mencegah concurrent ingestion                                    |
| **Session-scoped lock**            | Lock hidup selama session/conn hidup                          | `with db.connect()`                                                     | Menghindari lock “ke-lepas”                                      |
| **Polling**                        | Coba acquire lock berulang                                    | `while True: try_lock`                                                  | Non-blocking + kontrol timeout                                   |
| **Lock key**                       | String kunci lock                                             | `ingest:{schema}:{table}`                                               | Scope lock yang tepat                                            |
| **hashtext**                       | Mengubah string jadi hash bigint                              | `hashtext(:k)::bigint`                                                  | Diperlukan fungsi advisory_lock                                  |
| **Collision (hash)**               | Dua key beda punya hash sama                                  | risiko teoritis                                                         | Catatan enterprise risk                                          |
| **Error handling**                 | Pola try/except/finally                                       | rollback + drop staging + cleanup file                                  | Menjaga sistem bersih                                            |
| **Best-effort cleanup**            | Cleanup dicoba tapi tidak mem-block raise                     | drop staging dalam except                                               | Mengurangi residue resource                                      |
| **Observability**                  | Mudah dilihat/diukur saat runtime                             | logs, progress, (recommended metrics)                                   | Penting untuk prod ops                                           |
| **Metrics**                        | Angka pengukuran (rows/sec, durasi)                           | belum ada (recommended)                                                 | Membantu SLO/performance tuning                                  |
| **SLO/SLA**                        | Target reliabilitas/performance                               | konseptual                                                              | Enterprise ops standard                                          |
| **Unit test**                      | Test fungsi/komponen kecil                                    | utils, helper main, core ordering                                       | Cepat & stabil                                                   |
| **Integration test**               | Test dengan Postgres real                                     | COPY + swap end-to-end                                                  | Validasi behavior “asli”                                         |
| **Mock**                           | Objek palsu untuk test                                        | mock ports di core test                                                 | Mengisolasi core logic                                           |
| **Fixture**                        | Setup test reusable                                           | pytest `tmp_path`, `monkeypatch`                                        | Memudahkan test rapi                                             |
| **Contract test**                  | Test bahwa adapter memenuhi port                              | memastikan method & semantics                                           | Cocok untuk ports/adapters                                       |
| **Docker**                         | Container runtime                                             | service Postgres / pipeline                                             | Standard deploy env                                              |
| **Kestra**                         | Workflow orchestrator                                         | kamu sebut untuk module orchestration                                   | Scheduling/retries/flows                                         |
| **Schema namespace**               | “folder” table di Postgres                                    | `DB_SCHEMA`, `search_path`                                              | Organisasi & isolasi data                                        |
| **Public schema**                  | schema default Postgres                                       | fallback `public`                                                       | Standard Postgres                                                |
| **DataTalksClub NYC TLC data**     | Dataset sumber                                                | URL GitHub release                                                      | Sumber data ingestion                                            |

---

### Bonus: 1 paragraf “narasi interview” (lebih kuat)


> “Ini project CLI ingestion untuk memuat dataset NYC Taxi (CSV/TSV/Parquet) ke Postgres dengan pendekatan enterprise: arsitektur Ports & Adapters supaya core orchestration tidak tergantung implementasi DB, proses load selalu lewat staging table untuk validasi dulu, dan publish dilakukan aman via atomic swap atau append. Untuk performa, loader memakai PostgreSQL COPY FROM STDIN dengan streaming chunk/batch agar memory stabil untuk file besar. Untuk reliability, ada advisory lock session-scoped per schema+table supaya tidak ada dua job menulis target yang sama, ada atomic download pattern `.part → rename`, dan setelah load pipeline menjalankan ANALYZE supaya query planner Postgres punya statistik terbaru.”
